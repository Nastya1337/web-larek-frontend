# Проектная работа "Веб-ларек"

_Интернет-магазин с товарами для веб-разработчиков — Web-ларёк. В магазине можно посмотреть каталог товаров, добавить товары в корзину и сделать заказ._

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```bash
npm install
npm run start
```

или

```bash
yarn
yarn start
```

## Сборка

```bash
npm run build
```

или

```bash
yarn build
```

## Основные возможности

На главной странице отображается каталог продукции, где можно посмотреть подробные сведения о товарах и перейти к корзине с выбранными позициями. Если нажать кнопку «Купить», товар попадёт в корзину (при условии, что его там ещё нет). Кнопка «Убрать» удаляет товар из корзины.

Оформление заказа проходит в два этапа через всплывающие окна:

1. Первое окно — выбор метода оплаты и указание адреса доставки. Если адрес не указан, система выведет уведомление об ошибке.

2. Второе окно — ввод электронной почты и номера телефона. Если какое-то поле остаётся пустым, также появляется сообщение об ошибке.

После нажатия кнопки «Оплатить» пользователь видит подтверждение успешной оплаты, а корзина автоматически очищается.

## Примененные паттерны

# Архитектура проекта (MVP Pattern)

Проект реализован с использованием паттерна **Model-View-Presenter (MVP)**, что обеспечивает четкое разделение ответственности между компонентами и улучшает поддерживаемость кода.

## Компоненты системы

### Модель
Отвечает за работу с данными приложения. Реализована через следующие интерфейсы:

- `IProductNote` - интерфейс товара в корзине
- `IProductCard` - интерфейс карточки товара
- `IProduct` - интерфейс основного товара
- `IPaymentInfo` - данные оплаты
- `IContactInfo` - контактные данные
- `IOrder` - интерфейс заказа
- `IOrderFormError` - обработка ошибок формы
- `IOrderResult` - результат оформления заказа

### Представление
Отвечает за отображение данных и взаимодействие с пользователем. Включает:

- `IPage` - интерфейс страницы
- `IModal` - работа с модальными окнами
- `IForm` - интерфейс форм ввода

### Презентер
Связывает Model и View, управляя бизнес-логикой приложения. Реализован в основном скрипте:
[/src/index.ts](/src/index.ts)

## Преимущества архитектуры
- Четкое разделение ответственности
- Упрощение тестирования компонентов
- Гибкость при внесении изменений
- Улучшенная масштабируемость

## Архитектура приложения (бизнес логика)

![pocess](web-larek-frontend.process.svg)

## Базовый код

### Интерфейс `IProductNote`

> Отвечает за хранение основной информации о продукте.

Свойства:

- `id: string` - уникальный идентификатор товара;
- `title: string` - название товара;
- `price: number | null` - цена товара.

### Интерфейс `IProductCard`

> Класс наследуется от интерфейса [`IProductNote`](#интерфейс-iproductnote) и расширяет его свойства.

Свойства:

- `id: string` - уникальный идентификатор товара (наследуется от интерфейса [`IProductNote`](#интерфейс-iproductnote));
- `title: string` - название товара (наследуется от интерфейса [`IProductNote`](#интерфейс-iproductnote));
- `price: number | null` - цена товара (наследуется от интерфейса [`IProductNote`](#интерфейс-iproductnote));
- `category: string` - категория товара;
- `image: string` - ссылка на изображение товара.

### Интерфейс `IProduct`

> Интерфейс наследуется от интерфейса [`IProductCard`](#интерфейс-iproduct) и расширяет его свойства. Отвечает за хранение полной информации о продукте.

Свойства:

- `id: string` - уникальный идентификатор товара (наследуется от интерфейса [`IProductNote`](#интерфейс-iproductnote));
- `title: string` - название товара (наследуется от интерфейса [`IProductNote`](#интерфейс-iproductnote));
- `price: number | null` - цена товара (наследуется от интерфейса [`IProductNote`](#интерфейс-iproductnote));
- `category: string` - категория товара (наследуется от интерфейса [`IProductCard`](#интерфейс-iproductcard));
- `imageUrl: string` - ссылка на изображение товара (наследуется от интерфейса [`IProductCard`](#интерфейс-iproductcard));
- `description: string` - описание товара.

### Интерфейс `IOrder`

> Отвечает за оформление заказа. Наследуется от интерфейсов [`IPaymentInfo`](#интерфейс-ipaymentinfo) и [`IContactInfo`](#интерфейс-icontactinfo).

Свойства:

- `id: string` - идентификатор заказа товаров;
- `total: number` - полная стоимость заказа;
- `items:`[`IProduct`](#интерфейс-iproduct)`[]` - коллекция товаров, включенных в заказ.
- `payment: payment` - способ оплаты заказа, где тип `payment` является ограничением из двух значений: `online` и `offline`. Наследуется от интерфейса [`IPaymentInfo`](#интерфейс-ipaymentinfo):

  ```typescript
  type payment = 'online' | 'offline';
  ```

- `email: string` - адрес электронной почты пользователя (наследуется от интерфейса [`IPaymentInfo`](#интерфейс-ipaymentinfo));
- `phone: string` - номер телефона пользователя (наследуется от интерфейса [`IContactInfo`](#интерфейс-icontactinfo));
- `address: string` - адрес доставки заказа (наследуется от интерфейса [`IContactInfo`](#интерфейс-icontactinfo)).

### Интерфейс `IPaymentInfo`

> Объединяет способ оплаты товара и адрес электронной почты. Является первым шагом в оформлении заказа.

Свойства:

- `payment: payment` - способ оплаты заказа, где тип payment является ограничением из двух значений: `outline` и `upon delivery`.

  ```typescript
  type payment = 'online' | 'offline';
  ```

- `email: string` - адрес электронной почты пользователя.

### Интерфейс `IContactInfo`

> Объединяет действие по вводу номера телефона и адреса доставки заказа. Является вторым шагом в оформлении заказа.

Свойства:

- `phone: string` - номер телефона пользователя;
- `address: string` - адрес доставки заказа.

### Класс `Order`

> Отвечает за оформление заказа. Имплементирует интерфейсы [`IPaymentInfo`](#интерфейс-ipaymentinfo), [`IContactInfo`](#интерфейс-icontactinfo) и [`IOrder`](#интерфейс-iorder)

### Класс `EventEmitter`

> Брокер событий — это класс, позволяющий объектам подписываться на определённые типы событий и получать уведомления о них.

Функции:

- `on(eventName, callback)` - подписывается на определённый тип событий;
- `off(eventName, callback)` - отписывается от определённого типа событий;
- `emit(eventName, data)` - отправляет событие определённого типа;
- `onAll(callback)` - подписывается на все события;
- `offAll()` - отписывается от всех событий;
- `trigger(eventName, context)` - создаёт коллбек-триггер, который генерирует событие при вызове.

### Класс `Api`

> Класс `API` — класс, который позволяет отправлять запросы к API.

Методы:

- `getUri(uri: string)` — отправляет GET-запрос к указанному URI;
- `postUri(uri: string, data: object, method: ApiPostMethods = 'POST')` — отправляет POST-запрос к указанному URI (возможными вариантами могут быть `POST`, `PUT` или `DELETE`);
- `handleResponse()` - обрабатывает ответ сервера и возвращает объект в формате JSON.

### Интерфейс `IAppState`

> Интерфейс, отвечающий за бизнес-логику.

Свойства:

- `order: IProductNode[]` - коллекция продуктов, помещенных в заказ;

Функции:

- `getInitialStore(items: IProduct[]):void` - заполняет витрину приложения продуктами;
- `setProduct(item: IProductCard): void` - сохраняет продукт, находяийся в открытой карточке;
- `getProduct(): IProduct | null` - получает продукт, содержащийся в открытой карточке;
- `getProductInStore(id: string): IProduct` - получает продукт, размещенный в ветрине приложения, по его индексу;
- `initialOrder(): IOrder` - получение экземпляра "очищенного" заказа;
- `addProductToBasket (value: ISmallProductCard): void` - добавляет продукт в заказ;
- `removeProductFromBasket (value: ISmallProductCard): void`- удаляет продукт из заказа;
- `existsProductInBasket(value: ISmallProductCard): boolean` - проверяет наличие продукта в заказе, используется для изменения надписи кнопки;
- `getTotalBasketPrice(): number` - получает общую стоимость заказа;
- `setPaymentInfo(payment: payment, address: string): void` - вносит в заказ способ оплаты и адрес доставки;
- `validatePaymentInfo(): boolean` - проверяет корректность указания способа оплаты и адреса доставки;
- `setContactsInfo(email: string, phone: string): void` - вносит в заказ сведения о контакте: адресе электронной почты и номере телефона;
- `validateContactsInfo(): boolean` - проверяет корректность внесения в заказ адреса электронной почты и номера телефона;
- `pay():void` - выполняет оплату товара и очищает содержимое заказа;
- `clearOrder(): void` - процедура очистки заказа.

### Класс `AppData`

> Класс имплементирует интерфейс [`IAppState`](#интерфейс-iappstate) и отвечает за бизнес-логику приложения.

События:

- `store:render` - вызывается перерисовку витрины продуктов;
- `payment:ready` - вызывается при реализации проверки корректности заполнения информации об оплате;
- `paymentFormErrors:change` - вызывается по результату проверки корректности заполнения информации об оплате;
- `contacts:ready` - вызывается при реализации проверки корректности заполнения контактных данных;
- `contactFormErrors:change` - вызывается по результату проверки коеектности заполнения контактных данных;
- `order:pay` - вызывается по результату оплаты товара.
